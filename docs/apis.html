<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 APIs | My bookdown</title>
  <meta name="description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 APIs | My bookdown" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 APIs | My bookdown" />
  
  <meta name="twitter:description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Carolita Landers" />


<meta name="date" content="2023-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="apis-and-iteration.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>My Intro</a></li>
<li class="chapter" data-level="1" data-path="apis-and-iteration.html"><a href="apis-and-iteration.html"><i class="fa fa-check"></i><b>1</b> API’s and Iteration</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="apis-and-iteration.html"><a href="apis-and-iteration.html#lesson-objectives"><i class="fa fa-check"></i><b>1.0.1</b> Lesson Objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="apis.html"><a href="apis.html"><i class="fa fa-check"></i><b>2</b> APIs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="apis.html"><a href="apis.html#nps-visitation-data"><i class="fa fa-check"></i><b>2.1</b> NPS Visitation Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="apis.html"><a href="apis.html#exercise-1"><i class="fa fa-check"></i><b>2.1.1</b> Exercise #1</a></li>
<li class="chapter" data-level="2.1.2" data-path="apis.html"><a href="apis.html#exercise-2"><i class="fa fa-check"></i><b>2.1.2</b> Exercise #2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#functionize-api-pulls"><i class="fa fa-check"></i><b>3.1</b> Functionize API Pulls</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#exercise-3"><i class="fa fa-check"></i><b>3.1.1</b> Exercise #3</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#exercise-4"><i class="fa fa-check"></i><b>3.1.2</b> Exercise #4</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#function-defaults"><i class="fa fa-check"></i><b>3.2</b> Function Defaults</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#exercise-5"><i class="fa fa-check"></i><b>3.2.1</b> Exercise #5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="iterations.html"><a href="iterations.html"><i class="fa fa-check"></i><b>4</b> Iterations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="iterations.html"><a href="iterations.html#for-loops"><i class="fa fa-check"></i><b>4.1</b> For loops</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="iterations.html"><a href="iterations.html#exercise-6"><i class="fa fa-check"></i><b>4.1.1</b> Exercise #6</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="iterations.html"><a href="iterations.html#mapping"><i class="fa fa-check"></i><b>4.2</b> Mapping</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="iterations.html"><a href="iterations.html#exercise-7"><i class="fa fa-check"></i><b>4.2.1</b> Exercise #7</a></li>
<li class="chapter" data-level="4.2.2" data-path="iterations.html"><a href="iterations.html#lesson-objectives-1"><i class="fa fa-check"></i><b>4.2.2</b> Lesson Objectives</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iterations.html"><a href="iterations.html#pulling-in-necessary-packages-and-data-sets"><i class="fa fa-check"></i><b>4.3</b> Pulling in necessary packages and data sets</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="iterations.html"><a href="iterations.html#exercise-1-1"><i class="fa fa-check"></i><b>4.3.1</b> Exercise #1</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="iterations.html"><a href="iterations.html#exploring-our-data"><i class="fa fa-check"></i><b>4.4</b> Exploring our data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="iterations.html"><a href="iterations.html#exercise-2-1"><i class="fa fa-check"></i><b>4.4.1</b> Exercise #2</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="iterations.html"><a href="iterations.html#pivoting"><i class="fa fa-check"></i><b>4.5</b> Pivoting</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="iterations.html"><a href="iterations.html#exercise-3-1"><i class="fa fa-check"></i><b>4.5.1</b> Exercise #3</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="iterations.html"><a href="iterations.html#joining"><i class="fa fa-check"></i><b>4.6</b> Joining</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="iterations.html"><a href="iterations.html#exercise-4-1"><i class="fa fa-check"></i><b>4.6.1</b> Exercise #4</a></li>
<li class="chapter" data-level="4.6.2" data-path="iterations.html"><a href="iterations.html#exercise-5-1"><i class="fa fa-check"></i><b>4.6.2</b> Exercise #5</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="iterations.html"><a href="iterations.html#lesson-objectives-2"><i class="fa fa-check"></i><b>4.7</b> Lesson Objectives:</a></li>
<li class="chapter" data-level="4.8" data-path="iterations.html"><a href="iterations.html#streaflow-datasets"><i class="fa fa-check"></i><b>4.8</b> Streaflow Datasets</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="iterations.html"><a href="iterations.html#usgs-dataretrieval-r-package"><i class="fa fa-check"></i><b>4.8.1</b> USGS <code>dataRetrieval</code> R package</a></li>
<li class="chapter" data-level="4.8.2" data-path="iterations.html"><a href="iterations.html#cdwrs-api"><i class="fa fa-check"></i><b>4.8.2</b> CDWR’s API</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-1-2.html"><a href="exercise-1-2.html"><i class="fa fa-check"></i><b>5</b> Exercise #1</a></li>
<li class="chapter" data-level="6" data-path="exercise-2-2.html"><a href="exercise-2-2.html"><i class="fa fa-check"></i><b>6</b> Exercise #2</a></li>
<li class="chapter" data-level="7" data-path="exercise-3-2.html"><a href="exercise-3-2.html"><i class="fa fa-check"></i><b>7</b> Exercise #3</a></li>
<li class="chapter" data-level="8" data-path="exercise-4-2.html"><a href="exercise-4-2.html"><i class="fa fa-check"></i><b>8</b> Exercise #4</a></li>
<li class="chapter" data-level="9" data-path="exercise-5-2.html"><a href="exercise-5-2.html"><i class="fa fa-check"></i><b>9</b> Exercise #5</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My bookdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="apis" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> APIs<a href="apis.html#apis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>An API is software that acts as an intermediary between an online data warehouse (or server) and its users (or clients). As data scientists, APIs provide us a way to request clean and nicely-formatted data that the server will then send to our local computers, all within our RStudio console! To work with APIs, we will need to use two new packages: <code>httr</code>, which allows us to communicate with the API’s server, and <code>jsonlite</code>, which allows us to work with one of the most common API data formats, JSON. Let’s go ahead and load in our packages for this lesson:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="apis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="apis.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-3"><a href="apis.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<div id="nps-visitation-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> NPS Visitation Data<a href="apis.html#nps-visitation-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week, we will be exploring NPS visitor use data across the NPS system as a whole, and and across specific park units. Like many institutions, NPS has a server that stores all of this information (as well as many other things), and an API for users to be able to access it.</p>
<p>To utilize the NPS API in R, we first need to explore its <a href="https://irmaservices.nps.gov/">API’s data structure</a>. In almost every case, we use URLs to access specific data from APIs. To find the access URL for NPS visitation data, go to <a href="https://irmaservices.nps.gov/v3/rest/Stats/help">Stats Rest API - Documentation</a> (though not very intuitive, the NPS API calls its visitation data set “Stats”). Listed there you will see that all data associated with the “Stats” data set can be accessed using the base URL <a href="https://irmaservices.nps.gov/v3/rest/stats"><strong>https://irmaservices.nps.gov/v3/rest/stats</strong></a>. From there, you can tack on additional html text to access two different data sets: <strong>total/{year}</strong> and <strong>visitation</strong>.</p>
<p>For starters, let’s try accessing the <strong>total/{year}</strong>. This data set gives us total monthly visitation across all NPS park units, for a user-selected year:</p>
<p><a href="https://irmaservices.nps.gov/v3/rest/stats/total/%7BYEAR%7D" class="uri"><strong>https://irmaservices.nps.gov/v3/rest/stats/total/{YEAR}</strong></a></p>
<p>If you tried accessing that URL, you’ll have noticed it doesn’t take you anywhere. This is because the curly brackets {} signify locations in the URL that need to be updated by the user based on their specific needs. I’m curious about visitor use in my birth year, so let’s tweak the URL to access visitation data from 1992. In R, we can access this data using <code>httr</code>’s <code>GET()</code> function, replacing {YEAR} with 1992.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="apis.html#cb2-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1992&quot;</span>)</span>
<span id="cb2-2"><a href="apis.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="apis.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># view raw_data</span></span>
<span id="cb2-4"><a href="apis.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(raw_data)</span></span></code></pre></div>
<p>Viewing the data set as-is, you can see it is not super human-readable. This is because data sent from APIs is typically packaged using JavaScript Object Notation (JSON).</p>
<p>To unpack the data, we will first need to use <code>httr</code>’s <code>content()</code> function. In this example, we want the data to be extracted as <em>text,</em> since this is a data table. Moreover, its encoding is listed as <em>UTF-8</em>. The encoding parameter can be found by opening our raw data set in our R console:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="apis.html#cb3-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="co"># lists &#39;UTF-8&#39;</span></span></code></pre></div>
<pre><code>## Response [https://irmaservices.nps.gov/v3/rest/stats/total/1992]
##   Date: 2023-03-01 18:11
##   Status: 200
##   Content-Type: application/json; charset=utf-8
##   Size: 1.42 kB</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="apis.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert content to text</span></span>
<span id="cb5-2"><a href="apis.html#cb5-2" aria-hidden="true" tabindex="-1"></a>unpacked_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">content</span>(raw_data, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)  </span>
<span id="cb5-3"><a href="apis.html#cb5-3" aria-hidden="true" tabindex="-1"></a>unpacked_data</span></code></pre></div>
<pre><code>## [1] &quot;[{\&quot;Month\&quot;:1,\&quot;NonRecreationVisitors\&quot;:6209285,\&quot;RecreationVisitors\&quot;:10940618,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:2,\&quot;NonRecreationVisitors\&quot;:6010027,\&quot;RecreationVisitors\&quot;:11931340,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:3,\&quot;NonRecreationVisitors\&quot;:6756902,\&quot;RecreationVisitors\&quot;:15369139,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:4,\&quot;NonRecreationVisitors\&quot;:7255782,\&quot;RecreationVisitors\&quot;:21458739,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:5,\&quot;NonRecreationVisitors\&quot;:7690763,\&quot;RecreationVisitors\&quot;:26648530,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:6,\&quot;NonRecreationVisitors\&quot;:7593227,\&quot;RecreationVisitors\&quot;:33284625,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:7,\&quot;NonRecreationVisitors\&quot;:8438755,\&quot;RecreationVisitors\&quot;:41099305,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:8,\&quot;NonRecreationVisitors\&quot;:8056823,\&quot;RecreationVisitors\&quot;:38625804,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:9,\&quot;NonRecreationVisitors\&quot;:7329755,\&quot;RecreationVisitors\&quot;:26438266,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:10,\&quot;NonRecreationVisitors\&quot;:7105574,\&quot;RecreationVisitors\&quot;:23616057,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:11,\&quot;NonRecreationVisitors\&quot;:6507805,\&quot;RecreationVisitors\&quot;:14338165,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992},{\&quot;Month\&quot;:12,\&quot;NonRecreationVisitors\&quot;:6702698,\&quot;RecreationVisitors\&quot;:10943961,\&quot;UnitCode\&quot;:null,\&quot;UnitName\&quot;:null,\&quot;Year\&quot;:1992}]&quot;</code></pre>
<p>Second, we need to transform this string of text, which is still in JSON formatting, into a data frame using <code>jsonlite</code>’s <code>fromJSON()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="apis.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parse text from JSON to data frame</span></span>
<span id="cb7-2"><a href="apis.html#cb7-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(unpacked_data)</span>
<span id="cb7-3"><a href="apis.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="apis.html#cb7-4" aria-hidden="true" tabindex="-1"></a>final_data</span></code></pre></div>
<pre><code>##    Month NonRecreationVisitors RecreationVisitors UnitCode UnitName Year
## 1      1               6209285           10940618       NA       NA 1992
## 2      2               6010027           11931340       NA       NA 1992
## 3      3               6756902           15369139       NA       NA 1992
## 4      4               7255782           21458739       NA       NA 1992
## 5      5               7690763           26648530       NA       NA 1992
## 6      6               7593227           33284625       NA       NA 1992
## 7      7               8438755           41099305       NA       NA 1992
## 8      8               8056823           38625804       NA       NA 1992
## 9      9               7329755           26438266       NA       NA 1992
## 10    10               7105574           23616057       NA       NA 1992
## 11    11               6507805           14338165       NA       NA 1992
## 12    12               6702698           10943961       NA       NA 1992</code></pre>
<p>Hooray, you have now successfully pulled in an online data set using an API! 😁</p>
<div id="exercise-1" class="section level3 hasAnchor" number="2.1.1" style="color: maroon">
<h3><span class="header-section-number">2.1.1</span> Exercise #1<a href="apis.html#exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Using the code above as a starting point, pull in monthly NPS-wide visitation data for the years 1980, 1999, and 2018.</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="apis.html#cb9-1" aria-hidden="true" tabindex="-1"></a>raw_data1980 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1980&quot;</span>)</span>
<span id="cb9-2"><a href="apis.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="apis.html#cb9-3" aria-hidden="true" tabindex="-1"></a>raw_data1999 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1999&quot;</span>)</span>
<span id="cb9-4"><a href="apis.html#cb9-4" aria-hidden="true" tabindex="-1"></a>raw_data2018 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/2018&quot;</span>)</span></code></pre></div>
</div>
<div id="exercise-2" class="section level3 hasAnchor" number="2.1.2" style="color: maroon">
<h3><span class="header-section-number">2.1.2</span> Exercise #2<a href="apis.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Now, let’s explore the second NPS visitation data set, <a href="https://irmaservices.nps.gov/v3/rest/Stats/help">visitation</a>. This call pulls in monthly data for a specific park, across a specific time frame. Use your new API skills to pull in visitation data for Rocky Mountain National Park from 2010 through 2021, based on the API’s URL template. The unit code for Rocky Mountain National Park is ROMO. (Hint: an API URL can have multiple sections that need to be updated by the user.)</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="apis.html#cb10-1" aria-hidden="true" tabindex="-1"></a>raw_dataROMO<span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url=</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/visitation?unitCodes=ROMO&amp;startMonth=01&amp;startYear=2010&amp;endMonth=01&amp;endYear=2021&quot;</span>)</span>
<span id="cb10-2"><a href="apis.html#cb10-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-3"><a href="apis.html#cb10-3" aria-hidden="true" tabindex="-1"></a>unpackedROMO<span class="ot">&lt;-</span> httr<span class="sc">::</span> <span class="fu">content</span>(raw_dataROMO, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding=</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb10-4"><a href="apis.html#cb10-4" aria-hidden="true" tabindex="-1"></a>final_ROMO<span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(unpackedROMO)</span>
<span id="cb10-5"><a href="apis.html#cb10-5" aria-hidden="true" tabindex="-1"></a>final_ROMO</span></code></pre></div>
<pre><code>##     Month NonRecreationVisitors RecreationVisitors UnitCode          UnitName Year
## 1       1                  9833              64618     ROMO Rocky Mountain NP 2010
## 2       2                  6835              44576     ROMO Rocky Mountain NP 2010
## 3       3                  6778              70117     ROMO Rocky Mountain NP 2010
## 4       4                  6737              69097     ROMO Rocky Mountain NP 2010
## 5       5                 11780             180710     ROMO Rocky Mountain NP 2010
## 6       6                 22443             441738     ROMO Rocky Mountain NP 2010
## 7       7                 30683             668418     ROMO Rocky Mountain NP 2010
## 8       8                 29990             574638     ROMO Rocky Mountain NP 2010
## 9       9                 22514             461942     ROMO Rocky Mountain NP 2010
## 10     10                 10845             245770     ROMO Rocky Mountain NP 2010
## 11     11                  7714              67862     ROMO Rocky Mountain NP 2010
## 12     12                  6474              66335     ROMO Rocky Mountain NP 2010
## 13      1                  8131              68641     ROMO Rocky Mountain NP 2011
## 14      2                  6085              50540     ROMO Rocky Mountain NP 2011
## 15      3                  7229              73760     ROMO Rocky Mountain NP 2011
## 16      4                  5940              77183     ROMO Rocky Mountain NP 2011
## 17      5                 10025             163587     ROMO Rocky Mountain NP 2011
## 18      6                 27264             500733     ROMO Rocky Mountain NP 2011
## 19      7                 29070             743741     ROMO Rocky Mountain NP 2011
## 20      8                 25498             620534     ROMO Rocky Mountain NP 2011
## 21      9                 22179             483780     ROMO Rocky Mountain NP 2011
## 22     10                  9157             264617     ROMO Rocky Mountain NP 2011
## 23     11                  6514              68076     ROMO Rocky Mountain NP 2011
## 24     12                 11581              61749     ROMO Rocky Mountain NP 2011
## 25      1                    90              68537     ROMO Rocky Mountain NP 2012
## 26      2                    50              62036     ROMO Rocky Mountain NP 2012
## 27      3                    80             104374     ROMO Rocky Mountain NP 2012
## 28      4                    70             117053     ROMO Rocky Mountain NP 2012
## 29      5                   490             228950     ROMO Rocky Mountain NP 2012
## 30      6                  1400             500206     ROMO Rocky Mountain NP 2012
## 31      7                  2050             651722     ROMO Rocky Mountain NP 2012
## 32      8                  2300             589131     ROMO Rocky Mountain NP 2012
## 33      9                  1500             527172     ROMO Rocky Mountain NP 2012
## 34     10                   560             219946     ROMO Rocky Mountain NP 2012
## 35     11                   100              93714     ROMO Rocky Mountain NP 2012
## 36     12                    60              66776     ROMO Rocky Mountain NP 2012
## 37      1                    90              78022     ROMO Rocky Mountain NP 2013
## 38      2                    50              68831     ROMO Rocky Mountain NP 2013
## 39      3                    80              89691     ROMO Rocky Mountain NP 2013
## 40      4                    70              90379     ROMO Rocky Mountain NP 2013
## 41      5                   490             239184     ROMO Rocky Mountain NP 2013
## 42      6                  1400             602508     ROMO Rocky Mountain NP 2013
## 43      7                  2050             712583     ROMO Rocky Mountain NP 2013
## 44      8                  2300             621852     ROMO Rocky Mountain NP 2013
## 45      9                  1500             253467     ROMO Rocky Mountain NP 2013
## 46     10                   560              66275     ROMO Rocky Mountain NP 2013
## 47     11                   100              86379     ROMO Rocky Mountain NP 2013
## 48     12                    60              81970     ROMO Rocky Mountain NP 2013
## 49      1                    90              77633     ROMO Rocky Mountain NP 2014
## 50      2                    50              76881     ROMO Rocky Mountain NP 2014
## 51      3                    80              99077     ROMO Rocky Mountain NP 2014
## 52      4                    70              97100     ROMO Rocky Mountain NP 2014
## 53      5                   490             220532     ROMO Rocky Mountain NP 2014
## 54      6                  1400             538725     ROMO Rocky Mountain NP 2014
## 55      7                  2050             693685     ROMO Rocky Mountain NP 2014
## 56      8                  2300             616826     ROMO Rocky Mountain NP 2014
## 57      9                  1500             537694     ROMO Rocky Mountain NP 2014
## 58     10                   560             305651     ROMO Rocky Mountain NP 2014
## 59     11                   100              90915     ROMO Rocky Mountain NP 2014
## 60     12                    60              80032     ROMO Rocky Mountain NP 2014
## 61      1                    90              98928     ROMO Rocky Mountain NP 2015
## 62      2                    50              85123     ROMO Rocky Mountain NP 2015
## 63      3                    80             134304     ROMO Rocky Mountain NP 2015
## 64      4                    70             116959     ROMO Rocky Mountain NP 2015
## 65      5                   490             259711     ROMO Rocky Mountain NP 2015
## 66      6                  1400             608796     ROMO Rocky Mountain NP 2015
## 67      7                  2050             858426     ROMO Rocky Mountain NP 2015
## 68      8                  2300             765579     ROMO Rocky Mountain NP 2015
## 69      9                  1500             644350     ROMO Rocky Mountain NP 2015
## 70     10                   560             371558     ROMO Rocky Mountain NP 2015
## 71     11                   100             118398     ROMO Rocky Mountain NP 2015
## 72     12                    60              93784     ROMO Rocky Mountain NP 2015
## 73      1                    90             115207     ROMO Rocky Mountain NP 2016
## 74      2                    50             105125     ROMO Rocky Mountain NP 2016
## 75      3                    80             135053     ROMO Rocky Mountain NP 2016
## 76      4                    70             129967     ROMO Rocky Mountain NP 2016
## 77      5                   490             285868     ROMO Rocky Mountain NP 2016
## 78      6                  1400             700990     ROMO Rocky Mountain NP 2016
## 79      7                  2050             912507     ROMO Rocky Mountain NP 2016
## 80      8                  2300             772849     ROMO Rocky Mountain NP 2016
## 81      9                  1500             711110     ROMO Rocky Mountain NP 2016
## 82     10                   560             398525     ROMO Rocky Mountain NP 2016
## 83     11                   100             158553     ROMO Rocky Mountain NP 2016
## 84     12                    60              91831     ROMO Rocky Mountain NP 2016
## 85      1                    90              95602     ROMO Rocky Mountain NP 2017
## 86      2                    50              98832     ROMO Rocky Mountain NP 2017
## 87      3                    80             145110     ROMO Rocky Mountain NP 2017
## 88      4                    70             158360     ROMO Rocky Mountain NP 2017
## 89      5                   490             263222     ROMO Rocky Mountain NP 2017
## 90      6                  1400             741247     ROMO Rocky Mountain NP 2017
## 91      7                  2050             885478     ROMO Rocky Mountain NP 2017
## 92      8                  2300             782625     ROMO Rocky Mountain NP 2017
## 93      9                  1500             681160     ROMO Rocky Mountain NP 2017
## 94     10                   560             332526     ROMO Rocky Mountain NP 2017
## 95     11                   100             140223     ROMO Rocky Mountain NP 2017
## 96     12                    60             112830     ROMO Rocky Mountain NP 2017
## 97      1                    90             111422     ROMO Rocky Mountain NP 2018
## 98      2                    50              84245     ROMO Rocky Mountain NP 2018
## 99      3                    80             156434     ROMO Rocky Mountain NP 2018
## 100     4                    70             151975     ROMO Rocky Mountain NP 2018
## 101     5                   490             305993     ROMO Rocky Mountain NP 2018
## 102     6                  1400             720822     ROMO Rocky Mountain NP 2018
## 103     7                  2050             931929     ROMO Rocky Mountain NP 2018
## 104     8                  2300             798306     ROMO Rocky Mountain NP 2018
## 105     9                  1500             784480     ROMO Rocky Mountain NP 2018
## 106    10                   560             312757     ROMO Rocky Mountain NP 2018
## 107    11                   100             125349     ROMO Rocky Mountain NP 2018
## 108    12                    60             106781     ROMO Rocky Mountain NP 2018
## 109     1                    90             118152     ROMO Rocky Mountain NP 2019
## 110     2                    50              99873     ROMO Rocky Mountain NP 2019
## 111     3                    80             146414     ROMO Rocky Mountain NP 2019
## 112     4                    70             160259     ROMO Rocky Mountain NP 2019
## 113     5                   490             280351     ROMO Rocky Mountain NP 2019
## 114     6                  1400             698224     ROMO Rocky Mountain NP 2019
## 115     7                  2050             973992     ROMO Rocky Mountain NP 2019
## 116     8                  2300             830039     ROMO Rocky Mountain NP 2019
## 117     9                  1500             752320     ROMO Rocky Mountain NP 2019
## 118    10                   560             374003     ROMO Rocky Mountain NP 2019
## 119    11                   100             123376     ROMO Rocky Mountain NP 2019
## 120    12                    60             113050     ROMO Rocky Mountain NP 2019
## 121     1                    90             126866     ROMO Rocky Mountain NP 2020
## 122     2                    50             110667     ROMO Rocky Mountain NP 2020
## 123     3                    80              97690     ROMO Rocky Mountain NP 2020
## 124     4                    70                  0     ROMO Rocky Mountain NP 2020
## 125     5                   490              63051     ROMO Rocky Mountain NP 2020
## 126     6                  1400             491355     ROMO Rocky Mountain NP 2020
## 127     7                  2050             723478     ROMO Rocky Mountain NP 2020
## 128     8                  2300             580368     ROMO Rocky Mountain NP 2020
## 129     9                  1500             500019     ROMO Rocky Mountain NP 2020
## 130    10                   560             297665     ROMO Rocky Mountain NP 2020
## 131    11                   100             157875     ROMO Rocky Mountain NP 2020
## 132    12                    60             156165     ROMO Rocky Mountain NP 2020
## 133     1                    90             140715     ROMO Rocky Mountain NP 2021</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="apis-and-iteration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
